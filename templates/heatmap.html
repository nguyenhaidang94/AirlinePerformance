<!DOCTYPE html>
<html>
<head>
  <title>d3.js calendar heatmap graph</title>
  <!-- <link rel="stylesheet" type="text/css" href="dist/calendar-heatmap.min.css"> -->
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <script src="https://d3js.org/d3-dsv.v1.min.js"></script>
  <script src="https://d3js.org/d3-fetch.v1.min.js"></script>
  <!-- <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script> -->
  <link rel="stylesheet" href="{{url_for('static', filename='calendar-heatmap.min.css')}}">
</head>
<body>
	<a href="{{url_for('home')}}">back</a>
  <div id="calendar"></div>

  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js" charset="utf-8"></script> -->
  <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.10.2/d3.min.js" charset="utf-8"></script>-->
  <!-- <script src="dist/calendar-heatmap.min.js"></script> -->
  <script src="{{url_for('static', filename='calendar-heatmap.min.js')}}"></script>
  <script >
  (function () {
    //Initialize random data for the demo
    //var now = moment().endOf('day').toDate();
    //var time_ago = moment().startOf('day').subtract(10, 'year').toDate();

    // var data = d3.csvParse("http://127.0.0.1:5000/static/2019_2_heat_calendar.csv", function(d) {
    //   return{
    //     date: d.FL_DATE,
    //   };
    // });
     // var parseDate = d3.timeParse("%m/%d/%Y")
    // var data = d3.csv('http://127.0.0.1:5000/static/2019_2_heat_calendar.csv')
    //   .then(function(d){
    //     return{
    //       date:parseDate(d.FL_DATE)
    //     };
    //   });

    var data = d3.csv("http://127.0.0.1:5000/static/2019_3_heat_calendar.csv").then(function(d) {
      return d.map(elem => {
        return {
          date: elem.FL_DATE,
          details: [
            {
              'name': 'DEP_DEL15', date: elem.FL_DATE, value: elem.DEP_DEL15
            },
            {
              'name': 'ARR_DEL15', date: elem.FL_DATE, value: elem.ARR_DEL15
            }
          ]
        }
      })
    });

    // var example_data = d3.timeDays(time_ago, now).map(function (dateElement, index) {
    //   return {
    //     date: dateElement,
    //     details: Array.apply(null, new Array(Math.floor(Math.random() * 15))).map(function(e, i, arr) {
    //       return {
    //         'name': 'Project ' + Math.ceil(Math.random() * 10),
    //         'date': function () {
    //           var projectDate = new Date(dateElement.getTime());
    //           projectDate.setHours(Math.floor(Math.random() * 24));
    //           projectDate.setMinutes(Math.floor(Math.random() * 60));
    //           return projectDate;
    //         }(),
    //         'value': 3600 * ((arr.length - i) / 5) + Math.floor(Math.random() * 3600) * Math.round(Math.random() * (index / 365))
    //       }
    //     }),
    //     init: function () {
    //       this.total = this.details.reduce(function (prev, e) {
    //         return prev + e.value;
    //       }, 0);
    //       return this;
    //     }
    //   }.init();
    // });
    // var example_data = d3.csv("data.csv").then(function (data){
    //   return{
    //     date: data.Date,
    //     value: date.Comparison_Type
    //   }
    // });
    // var example_data = d3.csv("http://127.0.0.1:5000/static/data.csv",function(error, csv) {
    //
    //   csv.forEach(function(d) {
    //     d.Comparison_Type = parseFloat(d.Comparison_Type);
    //   });

     //var Comparison_Type_Max = d3.max(csv, function(d) { return d.Comparison_Type; });

      // var data = d3.nest()
      //   .key(function(d) { return d.Date; })
      //   //.rollup(function(d) { return  Math.sqrt(d[0].Comparison_Type / Comparison_Type_Max); })
      //   .rollup(function(d) { return  d[0].Comparison_Type; })
      //   .map(csv);

    // csv.forEach(function(d){
    //   d.summary = [{"name": d.Date,"value":d.Comparison_Type}];
    // });
    //   });
    // Set the div target id
    var div_id = 'calendar';

    // Set custom color for the calendar heatmap
    var color = '#cd2327';

    // Set overview type (choices are year, month and day)
    var overview = 'year';

    // Handler function
    var print = function (val) {
      console.log(val);
    };

    // Initialize calendar heatmap
    //calendarHeatmap.init(data, div_id, color, overview, print);
  })();
 </script>
</body>
</html>
